<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head><th:block th:replace="~{layout/header :: head('Thanh toán')}"></th:block></head>
<body>
<th:block th:replace="~{layout/header :: navbar}"></th:block>

<div class="container my-4">
    <h3 class="mb-4"><i class="fas fa-credit-card"></i> Thanh toán</h3>

    <div class="row">
        <div class="col-lg-7">
            <form th:action="@{/order/checkout}" method="post" class="card card-body">
                <input type="hidden" th:name="${_csrf?.parameterName}" th:value="${_csrf?.token}">
                <div class="mb-3">
                    <label class="form-label">Họ và tên</label>
                    <input class="form-control" name="shipName" th:value="${account?.fullname}" required>
                </div>
                <div class="mb-3">
                    <label class="form-label">Số điện thoại</label>
                    <input class="form-control" name="shipPhone" th:value="${account?.phone}" required>
                </div>
                <div class="mb-3">
                    <label class="form-label">Địa chỉ</label>
                    <textarea class="form-control" name="address" rows="2" th:text="${account?.address}" required></textarea>
                </div>
                <div class="mb-3">
                    <label class="form-label">Phương thức thanh toán</label>
                    <select class="form-select" name="paymentMethod" required>
                        <option value="COD">COD</option>
                        <option value="BANK">Chuyển khoản</option>
                        <option value="MOMO">MoMo</option>
                    </select>
                </div>
                <div class="mb-3">
                    <label class="form-label">Ghi chú</label>
                    <textarea class="form-control" name="note" rows="2" placeholder="Giao giờ hành chính..."></textarea>
                </div>
                <button class="btn btn-primary">Đặt hàng</button>
            </form>
        </div>

        <div class="col-lg-5">
            <div class="card">
                <div class="card-header bg-light fw-semibold">Đơn hàng</div>
                <div class="card-body">
                    <div class="mb-2" th:each="it : ${cartItems}">
                        <div class="d-flex align-items-center">
                            <img th:src="@{${it.product.image}}" style="width:50px;height:50px;object-fit:cover" class="rounded me-2" onerror="this.src='https://via.placeholder.com/50'">
                            <div class="flex-grow-1">
                                <div class="small" th:text="${it.product.name}">Product</div>
                                <div class="text-muted small">x <span th:text="${it.quantity}">1</span></div>
                            </div>
                            <div class="fw-semibold" th:text="${#numbers.formatDecimal(it.product.price * it.quantity,0,'COMMA',0,'POINT')} + ' ₫'">0 ₫</div>
                        </div>
                    </div>
                    <hr>
                    <div class="d-flex justify-content-between">
                        <span>Tổng cộng</span>
                        <strong class="text-danger" th:text="${#numbers.formatDecimal(cartTotal,0,'COMMA',0,'POINT')} + ' ₫'">0 ₫</strong>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<th:block th:replace="~{layout/footer :: footer}"></th:block>
<th:block th:replace="~{layout/footer :: scripts}"></th:block>
</body>
</html>
